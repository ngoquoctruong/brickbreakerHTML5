window.__require=function e(i,t,c){function o(s,a){if(!t[s]){if(!i[s]){var r=s.split("/");if(r=r[r.length-1],!i[r]){var l="function"==typeof __require&&__require;if(!a&&l)return l(r,!0);if(n)return n(r,!0);throw new Error("Cannot find module '"+s+"'")}s=r}var h=t[s]={exports:{}};i[s][0].call(h.exports,function(e){return o(i[s][1][e]||e)},h,h.exports,e,i,t,c)}return t[s].exports}for(var n="function"==typeof __require&&__require,s=0;s<c.length;s++)o(c[s]);return o}({Ball:[function(e,i){"use strict";cc._RF.push(i,"9b280YbFuZJv4QPGPL8e8iv","Ball"),cc.Class({extends:cc.Component,properties:{rigidbody:cc.RigidBody},init:function(e){this._isReady=!0,this.gameCtl=e,this.node.position=cc.v2(221,50),this.rigidbody.linearVelocity=cc.v2(0,0)},onLoad:function(){this.node.parent.on("touchmove",this.onTouchMove,this),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this)},onKeyDown:function(e){switch(e.keyCode){case cc.macro.KEY.back:cc.director.end();break;default:this._isReady&&(this._isReady=!1,this.rigidbody.linearVelocity=cc.v2(300,300))}},onBeginContact:function(e,i,t){switch(t.tag){case 1:this.gameCtl.onBallContactBrick(i.node,t.node);break;case 2:this.gameCtl.onBallContactGround(i.node,t.node);break;case 3:this.gameCtl.onBallContactPaddle(i.node,t.node);break;case 4:this.gameCtl.onBallContactWall(i.node,t.node)}},onTouchMove:function(){this._isReady&&(this._isReady=!1,this.rigidbody.linearVelocity=cc.v2(300,300))}}),cc._RF.pop()},{}],BrickLayout:[function(e,i){"use strict";cc._RF.push(i,"62398FSMJtHJ55jmSoqf4WF","BrickLayout");var t=e("./BrickView");cc.Class({extends:cc.Component,properties:{padding:0,spacing:0,cols:0,brickPrefab:cc.Prefab,bricksNumber:50},init:function(e){console.log("levelModel",e),this.node.removeAllChildren(),this.bricksNumber=e.column*e.row,this.brickMap=e.brickMap,this.cols=e.column;for(var i=0,c=0;c<this.bricksNumber;c++){var o=this.brickMap[i],n=c%this.cols,s=o[n],a=cc.instantiate(this.brickPrefab);a.getComponent(t).setBrickType(s),a.parent=this.node,a.x=this.padding+c%this.cols*(a.width+this.spacing)+a.width/2,a.y=-this.padding-Math.floor(c/this.cols)*(a.height+this.spacing)-a.height/2,n>=e.column-1&&(i+=1)}}}),cc._RF.pop()},{"./BrickView":"BrickView"}],BrickModel:[function(e,i){"use strict";cc._RF.push(i,"9d87e3ZgIhAN5ntEWz/8tei","BrickModel"),cc.Class({extends:cc.Component,properties:{},start:function(){}}),cc._RF.pop()},{}],BrickView:[function(e,i){"use strict";cc._RF.push(i,"446b9MwGVhLTYvIS/KH+BcI","BrickView"),cc.Class({extends:cc.Component,properties:{brickNode:cc.Node,brickSprite:cc.Sprite,brickTextures:[cc.SpriteFrame],collider:cc.PhysicsBoxCollider,hp:0,score:0},setBrickType:function(e){0===e?(this.brickSprite.spriteFrame=null,this.collider.node.active=!1):(this.brickSprite.spriteFrame=this.brickTextures[e],this.collider.node.active=!0,this.hp=e,this.score=2*e+10)},hitBall:function(){this.hp=Math.max(this.hp-1,0),this.hp>0?this.animateHitBrick():this.animateBreakBrick()},animateBreakBrick:function(){var e=this;cc.tween(this.brickNode).to(.25,{scale:{value:2,easing:"sineIn"}}).to(.25,{opacity:{value:0,easing:"sineIn"}}).call(function(){return e.collider.enabled=!1}).start()},animateHitBrick:function(){cc.tween(this.brickNode).to(.15,{scale:{value:1.5,easing:"sineIn"}}).to(.15,{scale:{value:1,easing:"sineIn"}}).start()}}),cc._RF.pop()},{}],GameCtl:[function(e,i){"use strict";cc._RF.push(i,"a337308uxxJva7vh8G06q7Z","GameCtl");var t=e("GameModel"),c=e("../model/LevelModel"),o=e("../view/BrickView");cc.Class({extends:cc.Component,properties:{gameView:e("GameView"),ball:e("Ball"),paddle:e("Paddle"),brickLayout:e("BrickLayout"),overPanel:e("OverPanel"),isStopGame:!1,brickHitSound:cc.AudioClip,brickBreakSound:cc.AudioClip,winSound:cc.AudioClip,loseSound:cc.AudioClip,bgmAudioSource:cc.AudioSource},onLoad:function(){cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,function(e){e.keyCode===cc.macro.KEY.back&&cc.director.end()}),this.physicsManager=cc.director.getPhysicsManager(),this.physicsManager.enabled=!0,this.gameModel=new t,this.startGame()},init:function(e){this.physicsManager.enabled=!0,this.gameModel.init(e.brickCount),this.gameView.init(this),this.ball.init(this),this.paddle.init(this),this.brickLayout.init(e),this.overPanel.init(this)},startGame:function(){cc.tween(this.bgmAudioSource).to(1,{volume:{value:.25,easing:"sineIn"}}).start(),this.isStopGame=!1;var e=this,i=cc.url.raw("resources/level1.json");cc.loader.load(i,function(i,t){var o=new c(t.json);console.log("config",o),e.init(o)})},pauseGame:function(){console.log("pauseGame"),this.physicsManager.enabled=!1,this.isStopGame=!0},resumeGame:function(){this.physicsManager.enabled=!0,this.isStopGame=!1},stopGame:function(){this.isStopGame=!0,this.physicsManager.enabled=!1,cc.audioEngine.play(this.loseSound,!1,1),this.overPanel.show(this.gameModel.score,0===this.gameModel.bricksNumber)},onBallContactBrick:function(e,i){var t=i.getComponent(o);t.hitBall(),0===t.hp?(cc.audioEngine.play(this.brickBreakSound,!1,1),this.gameModel.addScore(t.score),this.gameModel.minusBrick(1),this.gameView.updateScore(this.gameModel.score),this.gameModel.bricksNumber<=0&&(cc.audioEngine.play(this.winSound,!1,1),this.stopGame())):cc.audioEngine.play(this.brickHitSound,!1,1)},onBallContactGround:function(){this.stopGame()},onBallContactPaddle:function(){},onBallContactWall:function(){},onDestroy:function(){this.physicsManager.enabled=!1}}),cc._RF.pop()},{"../model/LevelModel":"LevelModel","../view/BrickView":"BrickView",Ball:"Ball",BrickLayout:"BrickLayout",GameModel:"GameModel",GameView:"GameView",OverPanel:"OverPanel",Paddle:"Paddle"}],GameModel:[function(e,i){"use strict";cc._RF.push(i,"dceaaRUaJhHJ6dPqgG9vpjt","GameModel"),cc.Class({extends:cc.Component,properties:{score:0,bricksNumber:0},init:function(e){this.score=0,this.bricksNumber=e},addScore:function(e){this.score+=e},minusBrick:function(e){this.bricksNumber-=e}}),cc._RF.pop()},{}],GameView:[function(e,i){"use strict";cc._RF.push(i,"e4735UW3lFPMoW0rK22obsG","GameView"),cc.Class({extends:cc.Component,properties:{scoreLabel:cc.Label},init:function(e){this.gameCtl=e,this.scoreLabel.string="0"},updateScore:function(e){this.scoreLabel.string=e}}),cc._RF.pop()},{}],LandingScene:[function(e,i){"use strict";cc._RF.push(i,"b85cfPHei5Aio/A9v0oIyPq","LandingScene"),cc.Class({extends:cc.Component,properties:{clickSound:cc.AudioClip,bgmAudioSource:cc.AudioSource,loading:cc.Node},onPlayButtonClicked:function(){var e=this;this.loading.active=!0,cc.director.loadScene("game"),cc.audioEngine.play(this.clickSound,!1,1),cc.tween(this.bgmAudioSource).to(1,{volume:{value:0,easing:"sineIn"}}).call(function(){return e.bgmAudioSource.stop()}).start()}}),cc._RF.pop()},{}],LevelModel:[function(e,i,t){"use strict";cc._RF.push(i,"f5bf7ZYQy9FtL2z6N3fxQuH","LevelModel"),t.__esModule=!0,t.default=void 0;var c=function(){function e(e){this.brickCount=this.getTotalBricks(e),this.column=Object.keys(e[0]).length,this.row=Object.keys(e).length,this.brickMap=e}return e.prototype.getTotalBricks=function(e){var i=0;for(var t in e)for(var c in e[t])0!==e[t][c]&&(i+=1);return i},e}();t.default=c,i.exports=t.default,cc._RF.pop()},{}],OverPanel:[function(e,i){"use strict";cc._RF.push(i,"60425zRIQ5LNIZ6KmZ5p/LN","OverPanel"),cc.Class({extends:cc.Component,properties:{resultLabel:cc.Label,scoreLabel:cc.Label},onLoad:function(){},init:function(e){this.gameCtl=e,this.node.active=!1},show:function(e,i){this.node.active=!0,this.resultLabel.string=i?"YOU WIN!":"YOU LOSE!",this.scoreLabel.string=e+""},onBtnRestart:function(){this.gameCtl.startGame()}}),cc._RF.pop()},{}],Paddle:[function(e,i){"use strict";cc._RF.push(i,"4dc82c1qO9KbZBsMZGbHlMV","Paddle"),cc.Class({extends:cc.Component,properties:{speed:500},onLoad:function(){this._minX=this.node.width/2,this._maxX=450-this.node.width/2,this.node.parent.on("touchmove",this.onTouchMove,this),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,this.onKeyUp,this)},update:function(e){if(!this._gameCtrl||!this._gameCtrl.isStopGame){var i=this.node.x;this._isMoveLeft?i=Math.max(this._minX,Math.min(this._maxX,i-this.speed*e)):this._isMoveRight&&(i=Math.max(this._minX,Math.min(this._maxX,i+this.speed*e))),this.node.x=i}},onKeyDown:function(e){switch(e.keyCode){case cc.macro.KEY.left:case cc.macro.KEY.a:this._isMoveLeft=!0;break;case cc.macro.KEY.right:case cc.macro.KEY.d:this._isMoveRight=!0}},onKeyUp:function(e){switch(e.keyCode){case cc.macro.KEY.left:case cc.macro.KEY.a:this._isMoveLeft=!1;break;case cc.macro.KEY.right:case cc.macro.KEY.d:this._isMoveRight=!1}},onTouchMove:function(e){if(!this._gameCtrl.isStopGame){var i=this.node.parent.convertToNodeSpaceAR(e.getLocation());this.node.x=Math.max(this._minX,Math.min(this._maxX,i.x))}},init:function(e){this.node.x=221,this._gameCtrl=e}}),cc._RF.pop()},{}],"use_v2.0.x_cc.Toggle_event":[function(e,i){"use strict";cc._RF.push(i,"00b34XidUlKmYJ4M7MFy5dJ","use_v2.0.x_cc.Toggle_event"),cc.Toggle&&(cc.Toggle._triggerEventInScript_check=!0),cc._RF.pop()},{}]},{},["use_v2.0.x_cc.Toggle_event","GameCtl","BrickModel","GameModel","LevelModel","Ball","BrickLayout","BrickView","GameView","LandingScene","OverPanel","Paddle"]);